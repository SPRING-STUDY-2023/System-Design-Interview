# 2장 개략적인 규모 추정
- 보편적으로 통용되는 성능 수치상에서 사고 실험을 행하여 **추정치를 계산하는 행위**로서, 어떤 설계가 **요구사항에 부합할 것인지** 보기 위한 것
- 규모 확장성을 표현하는 데 필요한 기본기에 능숙해야 한다. (특히 2의 제곱수, 응답지연 값, 가용성에 관계된 수치들에 대한 이해가 필요)

<br/>

## 2의 제곱수
- 데이터 볼륨의 최소 단위는 1바이트이고, 8비트로 구성된다.
- ASCII 문자 하나가 차지하는 메모리 크기가 1바이트이다.

<br/>

🔽 흔히 쓰이는 데이터 볼륨 단위

![image](https://github.com/SPRING-STUDY-2023/System-Design-Interview/assets/55437339/41967705-c290-4ed8-afc1-10fd7ad6d8c1)

<br/>

## 모든 프로그래머가 알아야 하는 응답지연 값

🔽 2010년에 공개된 통상적인 컴퓨터에서 구현된 연산들의 응답지연 값

![image](https://github.com/SPRING-STUDY-2023/System-Design-Interview/assets/55437339/38755bfb-68cb-4026-b4c5-8326539abac8)

<br/>

- 위의 수들을 알기 쉽게 시각화하기 위해, 한 구글 엔지니어가 한 도구를 개발했다.
- 도구가 보여주는 수치에는 최근 기술 동향이 반영되어 있다.

<br/>

🔽 위 도구를 사용하여 2020년 기준으로 시각화한 수치

![image](https://github.com/SPRING-STUDY-2023/System-Design-Interview/assets/55437339/49c22c8b-6998-4220-b6a6-10f646ed5eef)

- 메모리는 빠르지만 디스크는 아직도 느리다.
- 디스크 탐색(seek)은 가능한 한 피하라.
- 단순한 압축 알고리즘은 빠르다.
- 데이터를 인터넷으로 전송하기 전에 가능하면 압축하라.
- 데이터 센터는 보통 여러 지역(region)에 분산되어 있고, 센터들 간에 데이터를 주고받는 데는 시간이 걸린다.

<br/>

## 가용성에 관계된 수치들
- **고가용성** : 시스템이 오랜 시간동안 지속적으로 중단없이 운영될 수 있는 능력을 지칭하는 용어 (percent)
- **SLA(Service Level Agreement)** : 서비스 사업자가 보편적으로 사용하는 용어, 서비스 사업자와 고객 사이에 맺어진 합의

<br/>

🔽 9의 개수와 시스템 장애 시간(downtime) 사이의 관계

![image](https://github.com/SPRING-STUDY-2023/System-Design-Interview/assets/55437339/9b914b9d-20bc-4062-83e0-ada43dfa5b34)

- 가용시간은 관습적으로 숫자 9를 사용해 표시한다.
- 9가 많으면 많을수록 좋다.

<br/>

## 예제: 트위터 QPS와 저장소 요구량 추정

### 가정
- 월간 능동 사용자는 3억 명이다.
- 50%의 사용자가 트위터를 매일 사용한다.
- 평균적으로 각 사용자는 매일 2건의 트윗을 올린다.
- 미디어를 포함하는 트윗은 10% 정도다.
- 데이터는 5년간 보관된다.

<br/>

### 추정
- QPS(Query Per Second) 추정치
  - 일간 능동 사용자 = 3억 * 50% = 1.5억
  - QPS = 1.5억 * 2트윗 / 24시간 / 3600초 = 약 3500
  - 최대 QPS = 2 * QPS = 약 7000
 
- 미디어 저장을 위한 저장소 요구량
  - 평균 트윗 크기
    - tweet_id에 64바이트
    - 텍스트에 140바이트
    - 미디어에 1MB
  - 미디어 저장소 요구량: 1.5억 * 2 * 10% * 1MB = 30TB/일
  - 5년간 미디어를 보관하기 위한 저장소 요구량: 30TB * 365 * 5 = 약 55PB
 
<br/>

## 팁
- 가장 중요한 것은 **문제를 풀어 나가는 절차**이다. (for 문제 해결 능력)
- 근사치를 활용한 계산: 적절한 근사치를 활용하여 시간을 절약하라.
- 가정들은 적어둬라.
- 단위를 붙여라. (모호함 방지)
- 빈출 문제는 QPS, 최대 QPS, 저장소 요구량, 캐시 요구량, 서버 수 등을 추정하는 것이다.
